@page "/"
@inherits MoaComponentBase<IndexPageViewModel>

@{
    <PageTitle>Memories of Azeroth</PageTitle>
    <HeadContentTest Url="@NavigationManager.Uri" Title="Memories of Azeroth" Description="Memories of Azeroth" Image="@null" AltImage="@null"/>
}

<AuthorizeView>
    <Authorized>
        <AccountHeaderCardComponent Services="@this" AccountViewModel="@ViewModel.AccountViewModel" />
    </Authorized>
</AuthorizeView>


<OnThisDayHeader HeaderData="@ViewModel.OnThisDay" NavigationManager="@NavigationManager" TimeProvider="@TimeProvider"/>
<RecentPostsComponent Services="@this" AccountViewModel="@ViewModel.AccountViewModel" RecentPostsHelper="@ViewModel.RecentPostsHelper" />

@code {
    [Parameter, SupplyParameterFromQuery(Name = "page")] public string CurrentPage { get; init; }

    [Parameter, SupplyParameterFromQuery(Name = "type")] public string RecentPostType { get; init; }

    protected override async Task InternalComputeState()
    {
        await base.InternalComputeState();
        await ViewModel.ComputeState(CurrentPage, null, RecentPostType);
    }
}